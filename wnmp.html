<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WNMP & MongoDB & Redis  install</title>
</head>
<body marginheight="0">
<h1><a href="/#windows">[windows]</a> WNMP &amp; MongoDB &amp; Redis install</h1>
<h2>Data</h2>
<p>用于分离配置文件，日志，数据存储。

</p>
<p>先在创建
</p>
<pre><code>D:\Develop\data</code></pre>
<p>然后在这个目录下依次创建 
</p>
<pre><code>command(命令) 
config(配置) 
log(日志) 
mongod(数据目录) 
mysqld(数据目录) 
redisd(数据目录) 
temp(临时文件目录)</code></pre>
<h2>Nginx</h2>
<p>下载任意版本安装 <a href="http://nginx.org/download/">http://nginx.org/download/</a>

</p>
<p>解压到
</p>
<pre><code>D:\Develop\nginx\1.5.6</code></pre>
<p>复制文件
</p>
<pre><code>fastcgi.conf, mime.types
-&gt;
D:\Develop\data\config

D:\Develop\nginx\1.5.6\temp
-&gt;
D:\Develop\data\temp</code></pre>
<p>修改文件名
</p>
<pre><code>fastcgi.conf
-&gt;
nginx_fastcgi.conf

mime.types
-&gt;
nginx_mime.types</code></pre>
<p>创建目录(用于存放nginx日志)
</p>
<pre><code>D:\Develop\data\log\nginx</code></pre>
<p>创建nginx.conf
</p>
<pre><code>#user  nobody;
worker_processes  8;
worker_rlimit_nofile 65535;

error_log  log/nginx/error.log;

pid        temp/nginx.pid;

events {
    worker_connections  10240;
}

http {
    include       nginx_mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  log/nginx/access.log  main;

    sendfile        on;

    keepalive_timeout  600;

    upstream php_cgi_53 {
        server 127.0.0.1:9530;
        server 127.0.0.1:9531;
        server 127.0.0.1:9532;
        server 127.0.0.1:9533;
    }

    server {
        listen      80;
        server_name localhost;

        root  D:/Develop/website/www;
        index index.html index.htm index.php;

        location ~ \.php$ {
            fastcgi_pass   php_cgi_53;
            fastcgi_index  index.php;
            include        nginx_fastcgi.conf;
        }
    }
}

ps. 
line29: upstream php_cgi_53
line43: location ~ \.php$
如果不需要php可以进行注释 (#)</code></pre>
<p>创建启动脚本：
D:\Develop\data\command\nginx_start.bat
</p>
<pre><code>@echo off

cd d:/develop/data/

RunHiddenConsole d:/develop/nginx/1.5.6/nginx -c config/nginx.conf

echo Nginx start OK!</code></pre>
<p>创建结束脚本：
D:\Develop\data\command\nginx_stop.bat
</p>
<pre><code>@echo off

ps -k nginx.exe

echo Nginx stop OK!</code></pre>
<h2>PHP</h2>
<p>下载任意版本安装包 <a href="http://us2.php.net/downloads.php">http://us2.php.net/downloads.php</a>

</p>
<p>解压
</p>
<pre><code>D:\Develop\php\5.3.27</code></pre>
<p>复制 &amp;&amp; 重命名
</p>
<pre><code>php.ini-development-&gt;php.ini</code></pre>
<p>然后打开文件 &amp;&amp; 搜索
</p>
<pre><code>;cgi.fix_pathinfo=1

ps:
Windows Extensions根据自己的需求开启(去掉 ;extension= 前面的;即可)</code></pre>
<p>去掉前面 ; 让php支持cgi模式


</p>
<p>创建启动脚本：
D:\Develop\data\command\php_start.bat
</p>
<pre><code>@echo off

cd d:/develop/php/5.3.27/

RunHiddenConsole php-cgi -b 127.0.0.1:9530 -c php.ini
RunHiddenConsole php-cgi -b 127.0.0.1:9531 -c php.ini
RunHiddenConsole php-cgi -b 127.0.0.1:9532 -c php.ini
RunHiddenConsole php-cgi -b 127.0.0.1:9533 -c php.ini

echo PHP start OK!</code></pre>
<p>创建结束脚本：
D:\Develop\data\command\php_stop.bat
</p>
<pre><code>@echo off

ps -k php-cgi.exe

echo PHP stop OK!</code></pre>
<h2>Mysql</h2>
<p>下载任意版本安装包(zip) <a href="http://dev.mysql.com/downloads/mysql/">http://dev.mysql.com/downloads/mysql/</a>

</p>
<p>解压
</p>
<pre><code>D:\Develop\mysql\5.1.28</code></pre>
<p>在
</p>
<pre><code>D:\Develop\data\mysqld</code></pre>
<p>目录下创建 3306 目录，即端口

</p>
<p>然后拷贝到当前目录
</p>
<pre><code>D:\Develop\mysql\5.1.28\data\mysql
-&gt;
D:\Develop\data\mysqld\3306\mysql</code></pre>
<p>创建启动脚本：
D:\Develop\data\command\mysql_start.bat
</p>
<pre><code>@echo off

cd d:/develop/data/mysqld/3306/

RunHiddenConsole d:/develop/mysql/5.1.28/bin/mysqld-nt --port=3306 --socket=mysql.sock --pid-file=mysql.pid --datadir=%cd% --console

echo Mysql start OK!</code></pre>
<p>创建结束脚本：
D:\Develop\data\command\mysql_stop.bat
</p>
<pre><code>@echo off

ps -k mysqld-nt.exe

echo Mysql stop OK!</code></pre>
<h2>MongoDB</h2>
<p>下载任意安装包 <a href="http://www.mongodb.org/downloads">http://www.mongodb.org/downloads</a>

</p>
<p>解压
</p>
<pre><code>D:\Develop\mongo\2.2.2</code></pre>
<p>创建目录(日志)
</p>
<pre><code>D:\Develop\data\log\mongo</code></pre>
<p>创建目录(数据)
</p>
<pre><code>D:\Develop\data\mongod\27017</code></pre>
<p>创建启动脚本：
D:\Develop\data\command\mongo_start.bat
</p>
<pre><code>@echo off

cd d:/develop/data/

RunHiddenConsole d:/develop/mongo/2.2.2/bin/mongod --dbpath=mongod/27017/ --logpath=log/mongo/27017.log

echo Mongo start OK!</code></pre>
<p>创建结束脚本：
D:\Develop\data\command\mongo_stop.bat
</p>
<pre><code>@echo off

ps -k mongod.exe

echo Mongo stop OK!</code></pre>
<h2>Redis</h2>
<p>下载安装包 <a href="https://github.com/MSOpenTech/redis">https://github.com/MSOpenTech/redis</a>

</p>
<p>将压缩包里面的
</p>
<pre><code>\bin\release\redisbin64.zip</code></pre>
<p>解压到
</p>
<pre><code>D:\Develop\redis\2.4.5</code></pre>
<p>复制 &amp;&amp; 重命名
</p>
<pre><code>redis.conf
-&gt;
D:\Develop\data\config\redis_6379.conf</code></pre>
<p>创建启动脚本：
D:\Develop\data\command\redis_start.bat
</p>
<pre><code>@echo off

cd d:/develop/data/

RunHiddenConsole d:/develop/redis/2.4.5/redis-server config/redis_6379.conf

echo Redis start OK!</code></pre>
<p>创建结束脚本：
D:\Develop\data\command\redis_stop.bat
</p>
<pre><code>@echo off

ps -k redis-server.exe

echo Redis stop OK!</code></pre>
<h1>PS</h1>
<p><a href="https://www.google.com.hk/search?q=RunHiddenConsole">RunHiddenConsole.exe</a>
<a href="https://www.google.com.hk/search?q=windows+ps+command">PS.exe</a></p>

<script type="text/javascript" src="/inc/load.js"></script>

</body>
</html>
